DROP VIEW IF EXISTS AlbumsView;

CREATE TABLE IF NOT EXISTS
    "PlaylistAlbum" (
        "artists" TEXT NOT NULL,
        "album" TEXT NOT NULL,
        "track_count" INTEGER NOT NULL,
        "release_year" TEXT,
        "playlist" TEXT,
        "added_at" DATETIME NOT NULL,
        "created_at" DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
        "modified_at" DATETIME
    );

CREATE INDEX "IX_PlaylistAlbum_id" ON "PlaylistAlbum" ("artists" ASC);

CREATE INDEX "IX_PlaylistAlbum_id" ON "PlaylistAlbum" ("album" ASC);

CREATE INDEX "IX_PlaylistAlbum_id" ON "PlaylistAlbum" ("playlist" ASC);

CREATE INDEX "IX_PlaylistAlbum_id" ON "PlaylistAlbum" ("added_at" DESC);

CREATE INDEX "IX_PlaylistAlbum_release_year" ON "PlaylistAlbum" ("release_year" ASC);

CREATE INDEX "IX_PlaylistAlbum_artists_album" ON "PlaylistAlbum" ("artists", "album");

CREATE INDEX "IX_PlaylistAlbum_album_artists" ON "PlaylistAlbum" ("album", "artists");

CREATE INDEX "IX_PlaylistAlbum_artists_album" ON "PlaylistAlbum" ("artists", "album");

CREATE INDEX "IX_PlaylistAlbum_playlist_artists_album" ON "PlaylistAlbum" ("playlist", "artists", "album");

CREATE INDEX "IX_PlaylistAlbum_release_year_artists_album" ON "PlaylistAlbum" ("release_year", "artists", "album");

CREATE TRIGGER playlistalbum_modified
    after update
    on PlaylistAlbum
begin
    update PlaylistAlbum set modified_at = current_timestamp where id = new.id;
end;
